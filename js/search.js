var searchFunc=function(e,t,r){"use strict";var a=document.getElementById(t);var n=document.getElementById(r);n.innerHTML="<ul><span class='local-search-empty'>首次搜索，正在载入索引文件，请稍后……<span></ul>";$.ajax({url:e,dataType:"xml",success:function(e){var t=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get();n.innerHTML="";a.addEventListener("input",function(){var e='<ul class="search-result-list">';var r=this.value.trim().toLowerCase().split(/[\s\-]+/);n.innerHTML="";if(this.value.trim().length<=0){return}t.forEach(function(t){var a=true;var n=[];if(!t.title||t.title.trim()===""){t.title="Untitled"}var s=t.title.trim();var i=s.toLowerCase();var l=t.content.trim().replace(/<[^>]+>/g,"");var c=l.toLowerCase();var u=t.url;var f=-1;var o=-1;var h=-1;if(c!==""){r.forEach(function(e,t){f=i.indexOf(e);o=c.indexOf(e);if(f<0&&o<0){a=false}else{if(o<0){o=0}if(t==0){h=o}}})}else{a=false}if(a){e+="<li><a href='"+u+"' class='search-result-title'>"+s+"</a>";var v=l;if(h>=0){var p=h-20;var m=h+80;if(p<0){p=0}if(p==0){m=100}if(m>v.length){m=v.length}var d=v.substr(p,m);r.forEach(function(e){var t=new RegExp(e,"gi");d=d.replace(t,'<span class="search-keyword">'+e+"</span>")});e+='<p class="search-result-abstract">'+d+"...</p>"}e+="</li>"}});e+="</ul>";if(e.indexOf("<li>")===-1){return n.innerHTML="<ul><span class='local-search-empty'>没有找到内容，请尝试更换检索词。<span></ul>"}n.innerHTML=e})}});$(document).on("click","#search-close-icon",function(){$("#search-input").val("");$("#search-result").html("")})};var getSearchFile=function(){var e="/search.xml";searchFunc(e,"search-input","search-result")};